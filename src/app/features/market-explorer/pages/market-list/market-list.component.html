<div class="p-6 max-w-7xl mx-auto">
  <!-- header  -->
  <div class="mb-6">
    <h1 class="text-xl font-semibold text-gray-900">Market explorer</h1>
    <p class="text-md text-gray-500">Discover and analyse emerging markets</p>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <!-- search  -->
    <input
      [(ngModel)]="searchTerm"
      (input)="applyFilters()"
      type="text"
      placeholder="Search markets..."
      class="w-full font-medium border border-blue-500 rounded-lg py-2 px-4 text-sm w-full focus:outline-none focus:ring-2 focus:ring-blue-500 hover:border-blue-400"
    />
    <!-- category  -->
    <select
      [(ngModel)]="selectedCategory"
      (change)="applyFilters()"
      class="w-full rounded-lg text-sm px-4 py-2 cursor-pointer font-medium text-gray-700 border border-gray-300 bg-white hover:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:offset-0 transition-all duration-200"
    >
      <option value="All">All Categories</option>
      <option>Finance</option>
      <option>Technology</option>
      <option>Healthcare</option>
      <option>Education</option>
      <option>Agriculture</option>
      <option>Energy</option>
      <option>Retail</option>
      <option>Entertainment</option>
      <option>Infrastructure</option>
    </select>

    <!-- region  -->
    <select
      [(ngModel)]="selectedRegion"
      class="w-full px-4 py-2 rounded-lg cursor-pointer border border-gray-300 text-sm font-medium text-gray-700 bg-white hover:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-0 transition-all duration-200"
      (change)="applyFilters()"
    >
      <option value="All">All Regions</option>
      <option value="Global">Global</option>
      <option value="Africa">Africa</option>
      <option value="Asia">Asia</option>
      <option value="Europe">Europe</option>
      <option value="North America">North America</option>
    </select>

    <!-- growth  -->
    <select
      [(ngModel)]="selectedGrowth"
      (change)="applyFilters()"
      class="w-full px-4 py-2 rounded-lg border border-gray-300 text-sm font-medium text-gray-700 bg-white hover:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-0 cursor-pointer transition-all duration-200"
    >
      <option value="All" class="text-gray-700">All Growth Levels</option>
      <option value="High" class="text-green-700">High</option>
      <option value="Medium" class="text-yellow-700">Medium</option>
      <option value="Low" class="text-orange-700">Low</option>
    </select>
  </div>

  <!-- loading -->
  <div *ngIf="marketService.loading">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <div *ngFor="let _ of [1, 2, 3, 4, 5, 6]">
        <div class="h-40 bg-gray-100 rounded-lg animate-pulse"></div>
      </div>
    </div>
  </div>

  <!-- error -->
  <div
    *ngIf="marketService.error"
    class="p-4 bg-red-50 text-red-600 rounded-md mt-4"
  >
    Failed to load markets. Please try again
  </div>

  <!-- grid  -->
  <div
    *ngIf="!marketService.loading && !marketService.error"
    class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"
  >
    <div
      *ngFor="let market of filteredMarkets"
      class="shadow-md m-5 rounded-lg hover:shadow-md p-5 transition cursor-pointer bg-white"
    >
      <div class="flex justify-between items-start mb-3">
        <h3 class="text-md font-medium text-gray-500">
          {{ market.name }}
        </h3>
        <span
          class="text-xs rounded-full px-2 py-1"
          [ngClass]="{
            'bg-green-100 text-green-700': market.growthRate >= 15,
            'bg-yellow-100 text-yellow-700':
              market.growthRate >= 10 && market.growthRate < 15,
            'bg-red-100 text-red-700': market.growthRate < 10,
          }"
        >
          {{
            market.growthRate >= 15
              ? "High"
              : market.growthRate >= 10
                ? "Medium"
                : "Low"
          }}
        </span>
      </div>
      <div class="text-sm text-gray-500 mb-2">
        {{ market.category }} . {{ market.region }}
      </div>
      <div class="line-clamp-3 text-gray-600 text-sm mb-2">
        {{ market.description }}
      </div>
      <div class="flex justify-between text-gray-600 text-sm mb-2">
        <span>Risk Level</span>
        <span
          class="font-medium"
          [ngClass]="{
            'text-green-700': market.metrics.riskLevel === 'Low',
            'text-yellow-700': market.metrics.riskLevel === 'Medium',
            'text-red-700': market.metrics.riskLevel === 'High',
          }"
        >
          {{ market.metrics.riskLevel }}
        </span>
      </div>
      <div class="text-gray-600">
        <span class="block mb-1 text-sm">Top Players</span>
        <div class="flex flex-wrap gap-1">
          <span
            class="px-2 py-1 rounded bg-gray-100 text-xs"
            *ngFor="let player of market.metrics.topPlayers"
          >
            {{ player }}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
